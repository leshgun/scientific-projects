import time
import base64

n = int('''32317006071311007300714876688669951960444102669715484032130345427524655138867890893197201411522
9134636887179609218980194941195591504909210950881523864680284000322144662666444069867816996026
2797468322872227360602619681480719453980798171923885596354930942461814540933957810974481143135
4107205703468720731611931878424368249973182351404945065817400541336874976744103626693152811145
6532496605849040370725041424451186744519767685127050132828175612827071169499583370087541606008
6220793016885497292039415096296580612956901426534252152064408099275962907151866844964307651356
6804323831649313688445037677279552220734243055277387'''.replace('\n', '').replace(' ', ''))
e = 65537
c = int('''26996124776617032801899257225895956791246904143330980570722508190927838185250998050692888200406
6633931446575471334238044077141215026961258220976274962711800375904027458566152153737890231699
0969251616974517184503798527555726645377104825452229200579146367424761122519135134519000633137
3843225067845876268569259009624344881957572851366431595401576158338119929169954520118488254904
8352363048730097133273496308630706980986471106938502782635273291273365493524338721076032792569
0877123353191662071277296835715573175189012151319684682883092003635977172227175553030389727142
2311428126759875990736481731554013384555649576563441'''.replace('\n', '').replace(' ', ''))

def ferma(n, e, c):
    a = 0
    i = int(sqrt(n)) + 1
    t = i
    s = i
    ti = time.time()
    while i < n:
        if not (i - s) % 100000: print(f'--- {i - s} ({time.time() - ti} ) ---')
        t = i
        i += 1
        z = pow(t, 2) - n
        if is_square(z): break
            
    s = sqrt(z)
    p = t + s
    q = t - s
    fi = (p-1)*(q-1)
    d = inverse_mod(e, fi)
    x = pow(c, d, n)
    print('P:', p)
    print('Q:', q)
    print('D:', d)
    print('X:', x)
    return x

x = ferma(n, e, c)
k = hex(x)[2:]
if len(k) % 2: k = ('0' + k)
k = k.upper()
k = base64.b16decode(k)

print('KEY:', k)